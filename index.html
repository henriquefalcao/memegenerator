<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gerador de Memes com Papel HigiÃªnico</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background-color: #f0f0f0;
      padding: 2rem;
      margin: 0;
    }

    h1 {
      font-size: 1.8rem;
    }

    canvas {
      width: 100%;
      max-width: 500px;
      height: auto;
      border: 2px solid #333;
      margin-top: 1rem;
      background-color: white;
    }

    button, a.share-btn {
      margin-top: 1rem;
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      cursor: pointer;
      background-color: #333;
      color: white;
      border: none;
      border-radius: 5px;
      text-decoration: none;
      display: inline-block;
    }

    button:hover, a.share-btn:hover {
      background-color: #555;
    }

    a#whatsappBtn {
      background-color: #25d366;
    }

    a#whatsappBtn:hover {
      background-color: #1eb250;
    }
  </style>
</head>
<body>
  <h1>Gerador de Memes com Papel HigiÃªnico ðŸ§»</h1>
  <canvas id="memeCanvas" width="500" height="500"></canvas>
  <br>
  <button onclick="gerarMeme()">Gerar outro meme</button>
  <br>
  <a id="whatsappBtn" class="share-btn" href="#" target="_blank">Compartilhar no WhatsApp</a>
  <br>
  <button id="botaoCompartilhar">Compartilhar imagem</button>

  <script>
    const frases = [
      'Quando sÃ³ resta uma folha... ðŸ¥²',
      'Papel higiÃªnico: o verdadeiro herÃ³i',
      'VocÃª sÃ³ me lembra quando tÃ¡ no aperto!',
      'Isso sim Ã© rolo de verdade ðŸ˜…',
      'Economiza, guerreiro! ðŸ§»ðŸ”¥',
      'Me respeita, sou item de luxo!',
      'Pior que crise: sem papel higiÃªnico!',
      'Na escassez, cada folha vale ouro ðŸ’°',
      'Sou suave, mas salvo vidas!',
      'Rei do banheiro, humilde no trono ðŸ‘‘ðŸš½',
      'Sem mim, vocÃª nÃ£o Ã© nada!',
      'Cuidado: uso excessivo pode causar sumiÃ§o!',
      'Papel higiÃªnico: o melhor amigo nas horas difÃ­ceis',
      'Quando acaba, o desespero comeÃ§a...',
      'TÃ´ aqui por vocÃª. Literalmente.',
    ];

    const imagens = [
      'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Toiletpapier_%28Gobran111%29.jpg/1200px-Toiletpapier_%28Gobran111%29.jpg',
      'https://pbs.twimg.com/media/D3pDxvHWkAMf-7x.jpg',
      'https://images.tcdn.com.br/img/img_prod/750752/porta_papel_higienico_adesivo_colar_na_parede_inox_df_2417_1_31c45cdab7e6c61f3c4c2f674403b436.jpg',
      'https://cdn.awsli.com.br/600x700/1341/1341932/produto/203116546/suporte-givlmg.jpg',
      'https://github.com/henriquefalcao/memegenerator/papel-rosto-02.jpg',
      'https://github.com/henriquefalcao/memegenerator/papel-rosto-03.jpg'
    ];

    function gerarMeme() {
      const canvas = document.getElementById('memeCanvas');
      const ctx = canvas.getContext('2d');
      const imagem = new Image();
      const texto = frases[Math.floor(Math.random() * frases.length)];
      const imagemUrl = imagens[Math.floor(Math.random() * imagens.length)];

      imagem.crossOrigin = "anonymous";
      imagem.src = imagemUrl;

      imagem.onload = () => {
        canvas.width = imagem.width > 500 ? 500 : imagem.width;
        canvas.height = imagem.height > 500 ? 500 : imagem.height;

        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(imagem, 0, 0, canvas.width, canvas.height);

        ctx.font = 'bold 24px Impact';
        ctx.fillStyle = 'white';
        ctx.strokeStyle = 'black';
        ctx.lineWidth = 1; // borda mais fina
        ctx.textAlign = 'center';

        const linhas = wrapText(ctx, texto, canvas.width - 40);

        // Texto no topo
        linhas.forEach((linha, i) => {
          const y = 40 + i * 30;
          ctx.fillText(linha, canvas.width / 2, y);
          ctx.strokeText(linha, canvas.width / 2, y);
        });

        // Atualiza o botÃ£o do WhatsApp com link
        atualizarBotaoWhatsapp();
      };
    }

    function wrapText(ctx, text, maxWidth) {
      const words = text.split(' ');
      const lines = [];
      let line = '';
      for (let i = 0; i < words.length; i++) {
        const testLine = line + words[i] + ' ';
        const testWidth = ctx.measureText(testLine).width;
        if (testWidth > maxWidth && i > 0) {
          lines.push(line.trim());
          line = words[i] + ' ';
        } else {
          line = testLine;
        }
      }
      lines.push(line.trim());
      return lines;
    }

    function atualizarBotaoWhatsapp() {
      const texto = encodeURIComponent("Veja esse meme com papel higiÃªnico ðŸ§»: " + window.location.href);
      const link = `https://wa.me/?text=${texto}`;
      document.getElementById('whatsappBtn').href = link;
    }

    // Compartilhamento nativo com imagem (se suportado)
    document.getElementById('botaoCompartilhar').addEventListener('click', async () => {
      const canvas = document.getElementById('memeCanvas');
      canvas.toBlob(async (blob) => {
        const file = new File([blob], 'meme.png', { type: 'image/png' });
        if (navigator.canShare && navigator.canShare({ files: [file] })) {
          await navigator.share({
            files: [file],
            title: 'Meme com papel higiÃªnico',
            text: 'Veja esse meme que acabei de gerar!',
          });
        } else {
          alert("Seu navegador nÃ£o suporta compartilhamento de imagem diretamente.");
        }
      });
    });

    gerarMeme();
  </script>
</body>
</html>